% \section{RFFE experiment setup, results, and analysis}

% In this section, the experimental Radio-Frequency Front End circuit for an FM Receiver will be presented. The complete Block Diagram of the FM Receiver can be seen in Figure \ref{fig:RFFE_Block}.

% \begin{figure}[H]
%     \centering
%     \includegraphics*[width=0.7\textwidth]{Images/RFFE_Block.png}
%     \caption{FM Receiver RFFE Block Diagram}
%     \label{fig:RFFE_Block}
% \end{figure}

% This receiver is divided in two parts, first, the Analog circuit, consisting of the LNA, Mixer, Local Oscillator and finally, an ADC to allow the remaining signal processing to be made by the GNU-Radio.

% \subsection{RFFE circuit setup}

% To implement the Analog RFFE circuit present in Figure \ref{fig:RFFE_Circuit}, it was used one PCB mounted LNA, the ADC831 Mixer and for the Local Oscillator generator, it was used the ADF4351 PLL Synthesizer, this component generates a stable signal with the same phase of the modulated signal received in the antenna. For the ADC and the connection between the Analog circuit and the GNU-Radio Interface, the ADALM2000 was used. 

% \begin{figure}[H]
%     \centering
%     \includegraphics*[width=0.7\textwidth]{Images/RFFE_Circuit.jpeg}
%     \caption{FM Receiver RFFE Analog circuit}
%     \label{fig:RFFE_Circuit}
% \end{figure}

% After connecting the circuit to the supply, the PLL starts the phase locking sequence, and after a few moments, the ADF4351 signals the locking of the phase and generates the correct LO signal, with the Fourier Transform displayed in Figure \ref{fig:RFFE_LO}.

% \begin{figure}[H]
%     \centering
%     \includegraphics*[width=0.7\textwidth]{Images/RRFE_LO.jpeg}
%     \caption{LO spectrum generated by the PLL}
%     \label{fig:RFFE_LO}
% \end{figure}

% The resulting signal is then a Square wave with a fundamental frequency of approximately $90MHz$.

% Passing then to the GNU-Radio software, the full elements are presented in Figure \ref{fig:RFFE_GNU}.

% \begin{figure}[H]
%     \centering
%     \includegraphics*[width=0.7\textwidth]{Images/RFFE_GNU.jpeg}
%     \caption{GNU-Radio FM Receiver}
%     \label{fig:RFFE_GNU}
% \end{figure}

% In this part, it is present, first, the ADALM2000 interface, thus enabling connectivity between both sections of the FM Receiver, followed another Mixer, responsible for enabling synchronization with a specific carrier frequency different form the one present in the LO used previously, this allows a receiver with different receiving carrier frequencies, resulting in an FM Radio Receiver. Finally, the Wide-Band FM demodulator extracts the original data from the received signal.

% \subsection{Results}

% After tuning the Mixer in the GNU-Radio, it is possible to synchronize the receiver with any Radio Station transmitting FM signal. The results of the FM Receiver can be seen in Figure \ref{fig:RFFE_Result}.

% \begin{figure}[H]
%     \centering
%     \includegraphics*[width=0.7\textwidth]{Images/RFFE_Result.jpeg}
%     \caption{FM Receiver result}
%     \label{fig:RFFE_Result}
% \end{figure}

% As seen in Figure \ref{fig:RFFE_Result}, the FM Radio Station is correctly received, and the original audio signal is extracted from the modulated carrier, allowing the audio to be played in real-time.


\section{RFFE experiment setup, results, and analysis}

In this section, the experimental Radio-Frequency Front End (RFFE) circuit for an FM Receiver was presented. The complete Block Diagram of the FM Receiver can be seen in Figure \ref{fig:RFFE_Block}.

\begin{figure}[H]
    \centering
    \includegraphics*[width=0.7\textwidth]{Images/RFFE_Block.png}
    \caption{FM Receiver RFFE Block Diagram}
    \label{fig:RFFE_Block}
\end{figure}

This receiver was divided in two parts: first, the analog RFFE chain, and second, the digital processing stage implemented in GNU Radio. The analog chain consisted of the LNA, Mixer, and Local Oscillator, with the ADALM2000 acting as the ADC to interface with the digital stage.

\subsection{RFFE Chain Assembly and Operation}

\subsubsection{Analog Downconversion (LNA, PLL, Mixer)}
To implement the analog RFFE circuit, as shown in Figure \ref{fig:RFFE_Circuit}, a PCB-mounted LNA, the ADC831 Mixer, and the ADF4351 PLL Synthesizer \textsuperscript{\cite{adf4351:datasheet}} were used.
\begin{figure}[H]
    \centering
    \includegraphics*[width=0.7\textwidth]{Images/RFFE_Circuit.jpeg}
    \caption{FM Receiver RFFE Analog circuit}
    \label{fig:RFFE_Circuit}
\end{figure}

This RFFE stage was designed as a Low-IF receiver. The signal from the antenna was first amplified by the LNA to boost the signal level and establish a low system noise figure. This amplified RF signal (e.g., an FM station at $\approx \SI{91}{\mega\hertz}$) was fed to the RF input of the ADC831 mixer.

The ADF4351 PLL was configured as the Local Oscillator (LO) to generate a stable high-frequency tone. As shown in Figure \ref{fig:RFFE_LO}, the LO was programmed to a fundamental frequency of approximately \SI{90}{\mega\hertz}. The mixer combines the RF and LO signals, producing sum and difference frequencies ($f_{RF} \pm f_{LO}$). The difference frequency, known as the Intermediate Frequency (IF), was the desired output (e.g., $\SI{91}{\mega\hertz} - \SI{90}{\mega\hertz} = \SI{1}{\mega\hertz}$). This low-IF signal was then passed to the ADALM2000 for digitization.

\begin{figure}[H]
    \centering
    \includegraphics*[width=0.6\textwidth]{Images/RRFE_LO.jpeg}
    \caption{LO spectrum generated by the PLL, showing a fundamental at \SI{90}{\mega\hertz}.}
    \label{fig:RFFE_LO}
\end{figure}


\subsubsection{Gain and Noise Figure (NF) Estimation}

A theoretical cascade analysis of the analog chain was performed to estimate its performance. Using the component datasheets for the FM band ($\approx \SI{100}{\mega\hertz}$):
\begin{itemize}
    \item \textbf{LNA (0.1-2G Module):} Gain $G_1 \approx \SI{32}{\decibel}$, Noise Figure $NF_1 \approx \SI{2.0}{\decibel}$ \textsuperscript{\cite{spf5189z:datasheet}}
    \item \textbf{Mixer (ADC831):} Conversion Loss $L_2 = \SI{8.5}{\deci\bel}$ (so $G_2 = \SI{-8.5}{\decibel}$), Noise Figure $NF_2 \approx \SI{8.5}{\decibel}$ \textsuperscript{\cite{ad831:datasheet}}
\end{itemize}

The total gain $G_{total}$ is the sum of the gains in dB:
\begin{equation}
    G_{total} = G_1 + G_2 = \SI{32}{\decibel} - \SI{8.5}{\decibel} = \SI{23.5}{\decibel}
\end{equation}

For the Noise Figure, the Friis formula requires linear values (power ratios), not dB.
\begin{equation}
    NF_{\text{total, linear}} = NF_{1, \text{linear}} + \frac{NF_{2, \text{linear}} - 1}{G_{1, \text{linear}}}
\end{equation}

First, the values were converted from dB:
\begin{itemize}
    \item $G_1 \text{ (linear)} = 10^{(32 / 10)} \approx 1585$
    \item $NF_1 \text{ (linear)} = 10^{(2.0 / 10)} \approx 1.585$
    \item $NF_2 \text{ (linear)} = 10^{(8.5 / 10)} \approx 7.08$
\end{itemize}

Plugging these into the formula:
\begin{equation}
    NF_{\text{total, linear}} = 1.585 + \frac{7.08 - 1}{1585} = 1.585 + 0.0038 \approx 1.589
\end{equation}

Finally, converting the total noise figure back to dB:
\begin{equation}
    NF_{\text{total, dB}} = 10 \cdot \log_{10}(1.589) \approx \SI{2.01}{\decibel}
\end{equation}

The total estimated gain for the chain was $\mathbf{G_{total} = \SI{23.5}{\decibel}}$, and the total estimated Noise Figure was $\mathbf{NF_{total} \approx \SI{2.01}{\decibel}}$. This result clearly shows the purpose of the LNA: its high gain makes the noise contribution of the mixer negligible, so the total NF of the receiver is approximately equal to the NF of the LNA itself.

\subsubsection{Digital Processing (GNU Radio)}
The digitized IF signal from the ADALM2000 was processed in GNU Radio, as shown in Figure \ref{fig:RFFE_GNU}. This stream contains the $\approx \SI{1}{\mega\hertz}$ IF signal. A \textit{second} (digital) mixer was used to fine-tune the receiver. By setting this mixer's frequency, any FM station within the ADALM2000's bandwidth could be selected and shifted to baseband (DC). Finally, a Wide-Band FM (WBFM) demodulator block extracted the audio signal, which was sent to an audio sink.

\begin{figure}[H]
    \centering
    \includegraphics*[width=0.7\textwidth]{Images/RFFE_GNU.jpeg}
    \caption{GNU-Radio FM Receiver Flowgraph}
    \label{fig:RFFE_GNU}
\end{figure}


\subsection{Results and Analysis}

After tuning the digital mixer in the GNU Radio flowgraph, it was possible to synchronize the receiver with a local FM broadcast station. The spectrum of the demodulated audio signal is shown in Figure \ref{fig:RFFE_Result}.

\begin{figure}[H]
    \centering
    \includegraphics*[width=0.7\textwidth]{Images/RFFE_Result.jpeg}
    \caption{FM Receiver result: Spectrum of the demodulated audio signal.}
    \label{fig:RFFE_Result}
\end{figure}

As seen in Figure \ref{fig:RFFE_Result}, the FM radio station was correctly received. The original audio signal was successfully extracted from the carrier, allowing the audio to be played in real-time. 

\textbf{Comments on Audio Quality:} The received audio quality was clear and intelligible. Some audible background hiss (white noise) was present, which is expected. This noise floor is consistent with the RFFE chain's overall noise figure, which was theoretically estimated in the previous section.